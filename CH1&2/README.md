Proj 1: Basic Static Techniques (Lab 1-1) (30 Points)
===================================================

What you need:

*   A Windows computer (real or virtual) with an Internet connection
*   Recommended: the textbook: "Practical Malware Analysis"

Purpose
-------

You will practice the techniques in chapter 1 & 2.

Downloading the Lab Files
-------------------------

The Lab Files can be found by double clicking on the PracticalMalwareAnalysis-Labs.exe and will be extracted to a folder.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/73fe6d5f-6774-4e60-958f-57eb35f3365b)

```
The folder which contains the PracticalMalwareAnalysis-Labs.exe is found on desktop
```

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/031bbe8d-c783-40b6-986d-2b2c63b33e1d)


VirusTotal
----------

Upload the **Lab01-01.exe** and **Lab01-01.dll** files to [www.virustotal.com](http://www.virustotal.com)

Turn in the image showing your analysis of **Lab01-01.dll** as shown below.

We will grade it by checking the last digits of the SHA256 value.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/f3417cf7-a63e-42cd-8286-c13f88dcfef5)

Press the **PrntScrn** key to capture an imag of the whole desktop.

Open Paint and paste the image in with **Ctrl+V**.

Save this image with the filename "**Proj 1a from YOUR NAME**".

**YOU MUST SUBMIT WHOLE-DESKTOP IMAGES TO GET FULL CREDIT!**

PEview
------

You can download PEview from here:

[http://wjradburn.com/software/](http://wjradburn.com/software/)

Open the files in PEview. For each file, find the "Time Date Stamp" as shown below.

The files were both compiled on the same date within a minute of each other, indicating that they are part of the same package.

Turn in the image showing your analysis of **Lab01-01.exe** as shown below.

We will grade it based on the "Data" column of the "Time Date Stamp" field.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/e2ac1150-271c-43cd-a755-0451bd0420de)

Save this image with the filename "**Proj 1b from YOUR NAME**".

**YOU MUST SUBMIT WHOLE-DESKTOP IMAGES TO GET FULL CREDIT!**

PEiD
----

You can download PEiD here:

[http://www.softpedia.com/progDownload/PEiD-updated-Download-4102.html](http://www.softpedia.com/progDownload/PEiD-updated-Download-4102.html)

Open the files in PEiD. They are identified as "Microsoft Visual C++" files, which shows that they are unpacked.

Turn in the image showing your analysis of **Lab01-01.dll** as shown below.

We will grade it based on the "First Bytes".

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/93d33b6e-0cdd-411c-90dc-794741c5bd62)

Save this image with the filename "**Proj 1c from YOUR NAME**".

**YOU MUST SUBMIT WHOLE-DESKTOP IMAGES TO GET FULL CREDIT!**

BinText
-------

BinText is a handy tool to view strings.

Get it here:

[https://www.mcafee.com/us/downloads/free-tools/bintext.aspx#](https://www.mcafee.com/us/downloads/free-tools/bintext.aspx#)

Look at the strings for **Lab01-01.dll**.

Notice these items, as shown below:

*   **CreateProcessA** -- Windows API function used to launch a program
*   **Sleep** -- Windows API function used to sleep
*   **sleep** -- Commands that can be sent over the network to tell the malware to sleep

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/30d1f04e-b4cd-460d-8ec5-324259702457)

The command to launch a program is missing. To see it, click the **Filter** tab and adjust the "Min. text length" to **4** as shown below.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/3417fb14-43cc-4605-a86f-35a332c65e48)

Click the **Search** tab. At the top right, click **Go**.

Now you can see that the command to launch a program is **exec**, as shown below.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/773c2857-e9c4-433f-9a57-9f8f7242a4d8)

Turn in the image showing your analysis of **Lab01-01.dll** as shown above.

Below "sleep" and "hello" there is an IP address, starting with 127.

We will grade it by checking the last digits of the IP address.

Save this image with the filename "**Proj 1d from YOUR NAME**". Then collect the strings from the **Lab01-01.exe** file.

Notice these items, as shown below:

*   "**FindNextFileA**" and "**FindFirstFileA**" -- Windows functions to find files
*   "**.exe**" -- suggesting that it will search for EXE files
*   "**C:\\windows\\system32\\kerne132.dll**" -- fake DLL with "kerne132" instead of "kernel32"
*   "**C:\\Windows\\System32\\Kernel32.dll**" -- the real Windows kernel

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/dd0ad3fa-68fb-42b1-b4ab-0643b88d5368)

Dependency Walker
-----------------

You can download Dependency Walker here:

[http://www.dependencywalker.com/](http://www.dependencywalker.com/)

> Troubleshooting
> ---------------
> 
> If that link fails, use this alternate download link:
> 
> [https://samsclass.info/126/proj/depends22\_x86.zip](https://samsclass.info/126/proj/depends22_x86.zip)

Open **Lab01-01.exe** in Dependency Walker.

In the left pane, click **MSVCRT.DLL** as shown below.

There are several imports in the upper right pane, and exports in the middle right pane. Scan through them--these are normal for any EXE.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/62eeab3c-e46e-4be5-bd89-85d62a16371f)

In the left pane, click **KERNEL32.DLL**.

Turn in the image showing your analysis of **Lab01-01.exe** as shown below.

In the "PI^" section (Parent Import), you should see **FindNextFileA** and **FindFirstFileA** as shown below.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/4f2b86b0-27f8-4c9d-aafd-a90944cbe99e)

Save this image with the filename "**Proj 1e from YOUR NAME**". Open **Lab01-01.dll** in Dependency Walker. Notice that it imports functions from "WS2\_32.DLL".

WS2\_32.DLL has networking functions. The right center pane shows function names that perform networking tasks, such as "bind", "closesocket", and "connect", as shown below.

![image](https://github.com/Cyber-Security-Club-HTU/CSC-Malware-Analysis/assets/75253629/718f37e8-73b8-4e72-92f5-7b55971638f8)

Turning in your Project
-----------------------

Email the images showing the secret messages to csc@htu.edu.jo with the subject line: **Lab 1 - YOUR NAME**
